<div class="orders-index">
  <h1>Shipment Dashboard</h1>
  
  <a href="/orders/new">
    <div class="create-order-button">
    Create Order
    </div>
  </a>
  
<table>
  <tr>
    <th>Order Number</td>
    <th>Tacking Number</td>
    <th>Vendor</th>
    <th>Street Address</td>
    <th>City</th>
    <th>Shipped On</th>
    <th>Delivery Date</th>
    <th>Status</th>
    <th>Delivery Time</th>
    <th>Normal Time</th>
    <th>Report</th>
  </tr>
  <% @orders.each do |order| %> 
    <tr>
      <td><%= order.number %></td>
      <td><%= order.tracking_number %></td>
      <td><%= order.vendor.name %></td>
      <td><%= order.address %></td>
      <td><%= order.location.city %></td>
      <td><%= order.shipped_at.strftime("%B %e, %Y") %></td>
      <% if order.delivered_at %>
        <td><%= order.delivered_at.strftime("%B %e, %Y") %></td>
      <% else %>
        <td>Not-Delivered</td>
      <% end %>
      <% if order.delivered_at > Time.now.to_date %>
        <td class="pending">Pending</td>
      <% else %>
        <td>Delivered</td>
      <% end %>
      <% delivery_time = (order.delivered_at - order.shipped_at).to_i %> 
      <% normal_time = @deliveries.where(location_id: order.location.id, vendor_id: order.vendor.id).first.normal_time %>
      <td><%= delivery_time %></td>
      <td><%= normal_time %></td>
      <% if delivery_time < normal_time %>
        <td>Normal </td>
      <% elsif delivery_time == normal_time %>
        <td class="not-normal">Not Normal</td>
      <% else  %>
        <td class="very-late">Very Late</td>
      <% end %>
    </tr>
  <% end %>
</table>
</div>
